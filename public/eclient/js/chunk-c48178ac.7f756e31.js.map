{"version":3,"sources":["webpack:///./src/components/ApprovalBasic.vue?7611","webpack:///./src/views/Approvals.vue?3bf7","webpack:///./src/components/ApprovalBasic.vue?83db","webpack:///src/components/ApprovalBasic.vue","webpack:///./src/components/ApprovalBasic.vue?86eb","webpack:///./src/components/ApprovalBasic.vue","webpack:///src/views/Approvals.vue","webpack:///./src/views/Approvals.vue?1423","webpack:///./src/views/Approvals.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ApprovalBasic_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ApprovalBasic_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","attrs","id","on","click","getApprovalLists","model","value","callback","$$v","type","expression","title","approvals","approvalLists","count","staticRenderFns","ApprovalBasicvue_type_template_id_eaa956b2_render","_l","approval","$index","key","staticClass","trip","desc","cause","status","approvalStatus","_v","_s","userName","parseDate","createTime","slot","size","plain","to","name","query","approvalId","_e","ApprovalBasicvue_type_template_id_eaa956b2_staticRenderFns","ApprovalBasicvue_type_script_lang_js_","props","data","10","20","30","40","50","60","methods","date","Date","concat","getFullYear","getMonth","getDate","components_ApprovalBasicvue_type_script_lang_js_","component","Object","componentNormalizer","ApprovalBasic","Approvalsvue_type_script_lang_js_","components","limit","0","page","1","arguments","length","undefined","getApprovals","_this","$http","get","then","res","resData","errcode","approvalData","$store","commit","catch","lowEnough","mainWindow","document","getElementById","pageHeight","Math","max","scrollHeight","body","offsetHeight","viewportHeight","window","innerHeight","documentElement","clientHeight","pageYOffset","scrollTop","watchScroll","wait","mustTime","that","startTime","now","currentTime","clearTimeout","timeout","setTimeout","created","addEventListener","views_Approvalsvue_type_script_lang_js_","Approvals_component","__webpack_exports__"],"mappings":"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","file":"js/chunk-c48178ac.7f756e31.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApprovalBasic.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApprovalBasic.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"approvals\"}},[_c('van-tabs',{on:{\"click\":_vm.getApprovalLists},model:{value:(_vm.type),callback:function ($$v) {_vm.type=$$v},expression:\"type\"}},[_c('van-tab',{attrs:{\"title\":\"待审批\"}},[_c('ApprovalBasic',{attrs:{\"approvals\":_vm.approvalLists[0].approvals,\"count\":_vm.approvalLists[0].count}})],1),_c('van-tab',{attrs:{\"title\":\"已审批\"}},[_c('ApprovalBasic',{attrs:{\"approvals\":_vm.approvalLists[1].approvals,\"count\":_vm.approvalLists[1].count}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"approvalbasic\"}},[_vm._l((_vm.approvals),function(approval,$index){return _c('van-panel',{key:'approval-'+$index,staticClass:\"approval-panel\",attrs:{\"title\":approval.trip.title,\"desc\":approval.trip.cause,\"status\":_vm.approvalStatus[approval.status]}},[_c('div',{staticClass:\"approval-content\"},[_c('p',[_vm._v(\"申请人: \"+_vm._s(approval.userName))]),_c('p',[_vm._v(\"申请时间: \"+_vm._s(_vm.parseDate(approval.createTime)))])]),_c('div',{staticClass:\"approval-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('van-button',{staticClass:\"footer-btn\",attrs:{\"size\":\"small\",\"type\":\"primary\",\"plain\":\"\",\"to\":{name: 'approval', query: {id: approval.approvalId}}}},[_vm._v(\"详细\")])],1)])}),(!_vm.count)?_c('van-panel',{staticClass:\"approval-panel\",attrs:{\"title\":\"出差审批单\"}},[_c('div',{staticClass:\"approval-content\"},[_c('p',[_vm._v(\"当前没有出差审批单\")])]),_c('div',{staticClass:\"approval-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('van-button',{staticClass:\"footer-btn\",attrs:{\"size\":\"small\",\"type\":\"primary\",\"plain\":\"\",\"to\":{name: 'home'}}},[_vm._v(\"出差申请\")])],1)]):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"approvalbasic\">\n    <van-panel\n      :title=\"approval.trip.title\" \n      :desc=\"approval.trip.cause\" \n      :status=\"approvalStatus[approval.status]\" \n      class=\"approval-panel\" \n      v-for=\"(approval, $index) in approvals\" :key=\"'approval-'+$index\">\n      <div class=\"approval-content\">\n        <p>申请人: {{approval.userName}}</p>\n        <p>申请时间: {{parseDate(approval.createTime)}}</p>\n      </div>\n      <div slot=\"footer\" class=\"approval-footer\">\n        <van-button size=\"small\" type=\"primary\" plain class=\"footer-btn\" :to=\"{name: 'approval', query: {id: approval.approvalId}}\">详细</van-button>\n      </div>\n    </van-panel>\n    <van-panel v-if=\"!count\" title=\"出差审批单\" class=\"approval-panel\">\n      <div class=\"approval-content\">\n        <p>当前没有出差审批单</p>\n      </div>\n      <div slot=\"footer\" class=\"approval-footer\">\n        <van-button size=\"small\" type=\"primary\" plain class=\"footer-btn\" :to=\"{name: 'home'}\">出差申请</van-button>\n      </div>\n    </van-panel>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ApprovalBasic',\n  props: ['approvals', 'count'],\n  data() {\n    return {\n      approvalStatus: {\n        10: '待审批',\n        20: '审批中',\n        30: '审批通过',\n        40: '进入商旅',\n        50: '已拒绝',\n        60: '员工取消',\n      }\n    }\n  },\n  methods: {\n    parseDate(date) {\n      date = new Date(date)\n      return `${date.getFullYear()}年${date.getMonth() +1}月${date.getDate()}日`\n    },\n  }\n}\n</script>\n\n<style>\n.approval-footer {\n  text-align:right;\n}\n\n.footer-btn {\n  margin-left:10px;\n}\n\n.approval-content {\n  padding-left: 15px;\n}\n\n.approval-panel {\n  margin: 10px;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n}\n\n.a-z {\n  padding: 10px 15px;\n  font-size: 20px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApprovalBasic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ApprovalBasic.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ApprovalBasic.vue?vue&type=template&id=eaa956b2&\"\nimport script from \"./ApprovalBasic.vue?vue&type=script&lang=js&\"\nexport * from \"./ApprovalBasic.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ApprovalBasic.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"approvals\">\n    <van-tabs v-model=\"type\" @click=\"getApprovalLists\">\n      <van-tab title=\"待审批\">\n        <ApprovalBasic :approvals=\"approvalLists[0].approvals\" :count=\"approvalLists[0].count\" />\n      </van-tab>\n      <van-tab title=\"已审批\" >\n        <ApprovalBasic :approvals=\"approvalLists[1].approvals\" :count=\"approvalLists[1].count\" />\n      </van-tab>\n    </van-tabs>\n  </div>\n</template>\n\n<script>\nimport ApprovalBasic from '../components/ApprovalBasic'\nexport default {\n  name: 'approvals',\n  components: { ApprovalBasic },\n  data() {\n    return {\n      type: 0,\n      limit: 10,\n      approvalLists: {\n        0: {\n          page: 1,\n          count: 0,\n          approvals: [],\n        },\n        1: {\n          page: 1,\n          count: 0,\n          approvals: []\n        }\n      },\n    }\n  },\n  methods: {\n    getApprovalLists(type = 0) {\n      this.type = type;\n      if(this.approvalLists[type].approvals.length) {\n        return;\n      }\n      this.getApprovals(type)\n    },\n    getApprovals(type = 0) {\n      if(this.approvalLists[type].count && this.approvalLists[type].approvals.length >= this.approvalLists[type].count) {\n        return;\n      }\n      this.$http.get(`/ec/api/approvals/lists/manage?type=${type}&limit=${this.limit}&page=${this.approvalLists[type].page++}`).then(res =>{\n        let resData = res.data;\n        if(resData.errcode === 0) {\n          let approvalData = resData.data;\n          this.approvalLists[type].approvals = this.approvalLists[type].approvals.concat(approvalData.approvals)\n          this.approvalLists[type].count = approvalData.count || 0;\n\n          if(type === 0) {\n            this.$store.commit('setApprovalCount', this.approvalLists[type].count)\n          }\n        }\n      }).catch(()=>{})\n    },\n\n    lowEnough() {\n      let mainWindow = document.getElementById('approvals');\n      if(!mainWindow) return;\n      let pageHeight = Math.max(mainWindow.scrollHeight, document.body.offsetHeight);\n      let viewportHeight = window.innerHeight ||\n        document.documentElement.clientHeight ||\n        mainWindow.clientHeight || 0;\n      let scrollHeight = window.pageYOffset ||\n        document.documentElement.scrollTop ||\n        mainWindow.scrollTop || 0;\n      // 通过 真实内容高度 - 视窗高度 - 上面隐藏的高度 < 20，作为加载的触发条件\n      return pageHeight - viewportHeight - scrollHeight < 60;\n    },\n\n    watchScroll(wait=200, mustTime=3000) {\n      let that = this;\n      if (!this.startTime) {\n        this.startTime = Date.now();\n      }\n      let currentTime = Date.now();\n\n      return function () {\n        if ((currentTime - this.startTime) >= mustTime) {\n          this.startTime = currentTime;\n          clearTimeout(this.timeout)\n          if (that.lowEnough()) {\n            that.getApprovals(this.type);\n          }\n        } else {\n          clearTimeout(this.timeout)\n          this.timeout = setTimeout(function () {\n            this.startTime = Date.now();\n            if (that.lowEnough()) {\n             that.getApprovals(this.type);\n            }\n          }, wait)\n        }\n      }\n    },\n  },\n  created() {\n    this.getApprovals(0);\n    window.addEventListener('scroll', this.watchScroll(), true)\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Approvals.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Approvals.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Approvals.vue?vue&type=template&id=ab6a86d4&\"\nimport script from \"./Approvals.vue?vue&type=script&lang=js&\"\nexport * from \"./Approvals.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}