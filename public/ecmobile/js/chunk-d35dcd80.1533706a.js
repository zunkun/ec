(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d35dcd80"],{"1af6":function(t,e,a){var i=a("63b6");i(i.S,"Array",{isArray:a("9003")})},"469f":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("7d7b")},"5d73":function(t,e,a){t.exports=a("469f")},"62b9":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"nobalance"}},[a("van-panel",{attrs:{title:"基本信息"}},[a("van-cell-group",[a("van-cell",{attrs:{title:"姓名",value:t.application.userName}}),a("van-cell",{attrs:{title:"部门"}},[t._v("\n        "+t._s(t.application.deptName)+"\n      ")]),t.application.type?a("van-cell",{attrs:{title:"预算科目"}},[t._v("\n        "+t._s(t.feeMap[t.application.type])+"\n      ")]):t._e()],1)],1),a("van-panel",{attrs:{title:"申请原因"}},[a("van-field",{attrs:{type:"textarea",placeholder:"申请原因（必填，少于100字）"},model:{value:t.application.cause,callback:function(e){t.$set(t.application,"cause",e)},expression:"application.cause"}})],1),a("van-panel",{attrs:{title:"申请流程"}},[a("van-steps",{attrs:{direction:"vertical",active:t.active}},t._l(t.processLists,function(e,i){return a("van-step",{key:"process-"+i},[a("h3",[t._v(t._s(e.title))]),a("p",[t._v(t._s(e.userNames.join("、")))])])}),1)],1),a("div",{staticClass:"button-area"},[t.application.id?a("van-button",{attrs:{block:"",type:"warning",plain:""},on:{click:t.saveApplication}},[t._v("修改预算申请单 ")]):a("van-button",{attrs:{block:"",type:"primary",plain:""},on:{click:t.saveApplication}},[t._v("申请预算")])],1)],1)},s=[],r=a("768b"),n=(a("ac4d"),a("8a81"),a("ac6a"),{name:"nobalance",data:function(){return{active:0,feeMap:{trip:"差旅费",benefits:"福利费",others:"其他"},application:{group:{},type:"差旅"},process:{group:{},applications:[],approvals:[],finances:[]},processLists:[]}},methods:{initApplication:function(){var t=this.$store.state.user;this.application={userId:t.userId,userName:t.userName,deptId:"",deptName:"",cause:"",group:{}}},setDeptInfo:function(){var t=this,e=this.$store.state.user.departments||[];this.application.deptId=this.$route.query.deptId||e[0].deptId,this.$http.get("/ec/api/depts/".concat(this.application.deptId)).then(function(e){var a=e.data;if(0===a.errcode){var i=a.data;t.application.deptName=i.deptName,t.application.group=i.group||{}}}).catch(function(){})},getApplication:function(){var t=this;this.$route.query.id&&this.$http.get("/ec/api/applications/".concat(this.$route.query.id)).then(function(e){var a=e.data;0!==a.errcode?t.$toast.fail("获取费用申请单失败"):t.application=a.data})},saveApplication:function(){this.application.id?this.updateApplication():this.createApplication()},updateApplication:function(){var t=this;this.application.cause?this.$http.put("/api/applications/".concat(this.application.id),this.application).then(function(e){var a=e.data;0!==a.errcode?t.$toast.fail("修改失败"):t.$toast.success("修改成功")}):this.$toast("请正确填写申请单信息")},createApplication:function(){var t=this;this.application.cause?this.$http.post("/api/applications",this.application).then(function(e){var a=e.data;if(0===a.errcode)return t.$toast.success("申请成功"),void t.$router.push({name:"applybudgetdetil",query:{id:a.data.id}});t.$toast.fail("申请失败")}):this.$toast("请正确填写申请单信息")},initStaffProcess:function(){this.processLists.push({title:"申请预算",userNames:[]});var t=!0,e=!1,a=void 0;try{for(var i,s=this.process.applications.entries()[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var n=Object(r["a"])(i.value,2),o=n[0],c=n[1],p={title:"第".concat(o+1,"级主管审批"),userNames:[]};c.deptId===this.process.deptId&&(p.title="直接主管审批");var u=!0,l=!1,h=void 0;try{for(var f,d=c.users[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var v=f.value;p.userNames.push(v.userName)}}catch(A){l=!0,h=A}finally{try{u||null==d.return||d.return()}finally{if(l)throw h}}this.processLists.push(p)}}catch(A){e=!0,a=A}finally{try{t||null==s.return||s.return()}finally{if(e)throw a}}var y={title:"财务调整",userNames:[]},m=!0,b=!1,N=void 0;try{for(var $,g=this.process.finances[Symbol.iterator]();!(m=($=g.next()).done);m=!0){c=$.value;y.userNames.push(c.userName)}}catch(A){b=!0,N=A}finally{try{m||null==g.return||g.return()}finally{if(b)throw N}}this.processLists.push(y),this.processLists.push({title:"预算调出部门领导审批",userNames:[]}),this.processLists.push({title:"预算调入部门领导审批",userNames:[]}),this.processLists.push({title:"预算调整",userNames:[]})},getStaffProcess:function(t){var e=this;this.$http.get("/ec/api/processes/personal/".concat(t||this.application.deptId)).then(function(t){var a=t.data;0===a.errcode?(e.process=a.data||{},e.initStaffProcess()):e.$toast("获取申请流程失败")}).catch()},initProcess:function(){this.processLists.push({title:"申请预算",userNames:[]});var t=!0,e=!1,a=void 0;try{for(var i,s=this.process.applications.entries()[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var n=Object(r["a"])(i.value,2),o=n[0],c=n[1],p={title:"第".concat(o+1,"级主管审批"),userNames:[]};c.deptId===this.process.deptId&&(p.title="直接主管审批");var u=!0,l=!1,h=void 0;try{for(var f,d=c.users[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var v=f.value;p.userNames.push(v.userName)}}catch(A){l=!0,h=A}finally{try{u||null==d.return||d.return()}finally{if(l)throw h}}this.processLists.push(p)}}catch(A){e=!0,a=A}finally{try{t||null==s.return||s.return()}finally{if(e)throw a}}var y={title:"财务调整",userNames:[]},m=!0,b=!1,N=void 0;try{for(var $,g=this.process.finances.users[Symbol.iterator]();!(m=($=g.next()).done);m=!0){c=$.value;y.userNames.push(c.userName)}}catch(A){b=!0,N=A}finally{try{m||null==g.return||g.return()}finally{if(b)throw N}}this.processLists.push(y),this.processLists.push({title:"预算调出部门领导审批",userNames:[]}),this.processLists.push({title:"预算调入部门领导审批",userNames:[]}),this.processLists.push({title:"预算调整",userNames:[]})},getProcess:function(){var t=this;this.$route.query.id&&this.$http.get("/ec/api/processes/application/".concat(this.$route.query.id)).then(function(e){var a=e.data;if(0===a.errcode)return t.process=a.data,void t.initProcess()})}},created:function(){this.$route.query.id?(this.getApplication(),this.getProcess()):(this.initApplication(),this.setDeptInfo(),this.getStaffProcess(),this.application.type=this.$route.query.type||"trip")}}),o=n,c=a("2877"),p=Object(c["a"])(o,i,s,!1,null,null,null);e["default"]=p.exports},"768b":function(t,e,a){"use strict";var i=a("a745"),s=a.n(i);function r(t){if(s()(t))return t}var n=a("5d73"),o=a.n(n);function c(t,e){var a=[],i=!0,s=!1,r=void 0;try{for(var n,c=o()(t);!(i=(n=c.next()).done);i=!0)if(a.push(n.value),e&&a.length===e)break}catch(p){s=!0,r=p}finally{try{i||null==c["return"]||c["return"]()}finally{if(s)throw r}}return a}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(t,e){return r(t)||c(t,e)||p()}a.d(e,"a",function(){return u})},"7d7b":function(t,e,a){var i=a("e4ae"),s=a("7cd6");t.exports=a("584a").getIterator=function(t){var e=s(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},9003:function(t,e,a){var i=a("6b4c");t.exports=Array.isArray||function(t){return"Array"==i(t)}},a745:function(t,e,a){t.exports=a("f410")},f410:function(t,e,a){a("1af6"),t.exports=a("584a").Array.isArray}}]);
//# sourceMappingURL=chunk-d35dcd80.1533706a.js.map